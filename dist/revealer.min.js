/*! revealer v1.0.0 | (c) 2015 Pete Redmond |  */
!function(e,t){"use strict";if("function"==typeof define&&define.amd)define(["angular"],t);else{if("undefined"==typeof module||"object"!=typeof module.exports)return t(e.angular);module.exports=t(require("angular"))}}(this,function(e){"use strict";function t(t,l){function c(c,u,f){function p(e){e.preventDefault();var t,r="mousemove"===e.type?e:e.changedTouches[0],n=a(r,y);n.x+=C,n.x<0||n.x>y.width||(t=n.x/y.width*100,o(_,h,t))}function v(e){if(e.preventDefault(),s(u,l,c.scrollOffset)){var t=n(u[0].parentNode).top,r=window.innerHeight-500,a=(r-t)/r*100;a>0&&100>a&&o(_,h,a)}}function d(o){var r=o.type===m[0].release?0:1,a=m[r];c.onComplete&&c.onComplete(),_.removeClass(x),t.off(a.move,P),t.off(a.release,d),c.pageScroll&&e.element(l).off("scroll",L)}if(!c.topimage&&!c.topImage||!c.bottomimage&&!c.bottomImage)throw Error("please provide a valid path for the top and bottom image attributes on the revealer directive");var g=!isNaN(parseInt(c.startPosition,10))&&c.startPosition<100,b=c.startPosition=g?parseInt(c.startPosition,10):50;c.scroll=c.scroll===!0?!0:!1,c.scrollOffset=c.scrollOffset||0;var _,h,w,x,y,I,C=0,P=i(p,40),L=i(v,20);t.ready(function(){_=r(u,".revealer__handle"),h=r(u,".revealer__top-image"),w=r(u,".revealer__container"),x="revealer__handle--drag",c.scroll&&e.element(l).on("scroll",L),c.pageScroll?o(_,h,0):o(_,h,b),e.forEach(m,function(e){_.on(e.action,function(o){var r;_.addClass(x),y=n(w),I=n(_),r=a(o,I).x,C=r>I.width/2?-(r-I.width/2):I.width/2-r,t.on(e.move,P),t.on(e.release,d)})})})}return{restrcit:"E",template:['<div class="revealer__container">','<img class="revealer__image" ng-src="{{bottomimage || bottomImage}}">','<span class="revealer__label revealer__label--right">{{bottomlabel || bottomLabel}}</span>','<div class="revealer__top-image">','<img class="revealer__image" ng-src="{{topimage || topImage}}">','<span class="revealer__label revealer__label--left">{{toplabel || topLabel}}</span>',"</div>",'<span class="revealer__handle"></span>',"</div>"].join(""),scope:{bottomlabel:"@",bottomLabel:"@",toplabel:"@",topLabel:"@",bottomimage:"@",bottomImage:"@",topimage:"@",topImage:"@",startPosition:"@",onComplete:"&",scroll:"=?",scrollOffset:"=?"},link:c}}function o(e,t,o){e.css({left:l(o)}),t.css({width:l(o)})}function r(t,o){return e.element(t[0].querySelector(o))}function a(e,t){return{x:e.clientX-t.left}}function n(e){return e=e[0]||e,e.getBoundingClientRect()}function l(e){return e+"%"}function i(e,t){function o(){a=!1}var r=this,a=!1;return function(){a||(e.apply(r,arguments),a=!0,setTimeout(o,t))}}function s(e,t,o){o=o||0;var r=n(e[0].parentNode||e);return!!r&&r.bottom>=0&&r.top<=t.innerHeight-o}var c="revealer";e.module(c,[]).directive("revealer",t);var m=[{action:"mousedown",move:"mousemove",release:"mouseup"},{action:"touchstart",move:"touchmove",release:"touchend"}];return t.$inject=["$document","$window"],c});